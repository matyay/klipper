# This file contains common pin mappings for the GTM32 PRO board in the Geeetech 301 printer
# To use this config, the firmware should be compiled for the
# STM32F103 with "No bootloader" and with "Use USB for communication"
# disabled.

# The "make flash" command does not work on the GTM32 PRO. Instead,
# after running "make", run the following command to flash the board:
#  stm32flash -w out/klipper.bin -v -i rts,-dtr,dtr /dev/ttyUSB0

# See docs/Config_Reference.md for a description of parameters.

[board_pins gtm32_pro_vb]
aliases_probes: X_MIN=PE5,X_MAX=PE4,Y_MIN=PE3,Y_MAX=PE2,Z_MIN=PE1,Z_MAX=PE0
aliases_temp: E0_TEMP=PC0,T0_PWM=PB4,E1_TEMP=PC1,T1_PWM=PB5,E2_TEMP=PC2,T2_PWM=PB0,BED_TEMP=PC3,BED_PWM=PB1
aliases_other: FAN0_PWM=PB7,FAN1_PWM=PB8,FAN2_PWM=PB9,BEEP=PB10,LED_PWM=PD12
aliases_motors: X_EN=PA8,X_DIR=PD13,X_STEP=PC6,Y_EN=PA15,Y_DIR=PA11,Y_STEP=PA12,Z_EN=PB3,Z_DIR=PD3,Z_STEP=PD6,E0_EN=PC15,E0_DIR=PC13,E0_STEP=PC14,E1_EN=PA1,E1_DIR=PB6,E1_STEP=PA0,E2_EN=PC4,E2_DIR=PB11,E2_STEP=PB2
aliases_lcd: LCD_ENC1=PE9,LCD_ENC2=PE8,LCD_PUSH=PE13,LCD_BEEP=PE12,LCD_RS=PE6,LCD_E=PE14,LCD_D4=PD8,LCD_D5=PD9,LCD_D6=PD10,LCD_D7=PE15

[multi_pin heater]
pins: T0_PWM,T1_PWM,T2_PWM

[multi_pin printhead_fans]
pins: FAN1_PWM,FAN2_PWM

[thermistor bed_thermistor]
temperature1: 24
resistance1: 104600
temperature2: 40
resistance2: 47700
temperature3: 67
resistance3: 13000

[stepper_a]
step_pin: X_STEP
dir_pin: !X_DIR
enable_pin: !X_EN
microsteps: 16
rotation_distance: 40
endstop_pin: ^X_MAX
homing_speed: 50
position_endstop: 216
arm_length: 201

[stepper_b]
step_pin: Y_STEP
dir_pin: !Y_DIR
enable_pin: !Y_EN
microsteps: 16
rotation_distance: 40
endstop_pin: ^Y_MAX

[stepper_c]
step_pin: Z_STEP
dir_pin: !Z_DIR
enable_pin: !Z_EN
microsteps: 16
rotation_distance: 40
endstop_pin: ^Z_MAX

[extruder]
step_pin: E0_STEP
dir_pin: !E0_DIR
enable_pin: !E0_EN
microsteps: 16
rotation_distance: 32
nozzle_diameter: 0.4
filament_diameter: 1.75
heater_pin: multi_pin:heater
sensor_type: EPCOS 100K B57560G104F
sensor_pin: E2_TEMP
min_extrude_temp: 160
min_temp: 0
max_temp: 250

[extruder1]
step_pin: E1_STEP
dir_pin: !E1_DIR
enable_pin: !E1_EN
microsteps: 16
rotation_distance: 32
nozzle_diameter: 0.4
filament_diameter: 1.75
shared_heater: extruder

[extruder2]
step_pin: E2_STEP
dir_pin: !E2_DIR
enable_pin: !E2_EN
microsteps: 16
rotation_distance: 32
nozzle_diameter: 0.4
filament_diameter: 1.75
shared_heater: extruder

[heater_bed]
heater_pin: BED_PWM
sensor_type: bed_thermistor
sensor_pin: BED_TEMP
min_temp: 0
max_temp: 150

[temperature_sensor board]
sensor_type: temperature_mcu
gcode_id: MCU

[temperature_sensor secondary]
sensor_pin: E1_TEMP
sensor_type: EPCOS 100K B57560G104F
gcode_id: SEC

[temperature_sensor ambient]
sensor_pin: E0_TEMP
sensor_type: EPCOS 100K B57560G104F
gcode_id: AMB

[homing_heaters]
heaters: extruder

[fan]
pin: FAN0_PWM

[heater_fan printhead]
pin: multi_pin:printhead_fans
heater: extruder
max_power: 0.6
off_below: 0.2
shutdown_speed: 0

[mixingextruder]
extruders: extruder,extruder1,extruder2

[mcu]
serial: /dev/serial/by-id/usb-FTDI_FT232R_USB_UART_AH06IBBC-if00-port0
restart_method: cheetah

[printer]
kinematics: delta
max_velocity: 300
max_accel: 3000
max_z_velocity: 150
delta_radius: 94

[output_pin beep]
pin: BEEP

[output_pin lcd_beep]
pin: LCD_BEEP

[display]
lcd_type: hd44780
rs_pin: LCD_RS
e_pin: LCD_E
d4_pin: LCD_D4
d5_pin: LCD_D5
d6_pin: LCD_D6
d7_pin: LCD_D7
encoder_pins: ^LCD_ENC1,^LCD_ENC2
click_pin: ^LCD_PUSH
